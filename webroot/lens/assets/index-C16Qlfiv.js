function Nn(n,r){let e=0;if(r===void 0)for(let t of n)(t=+t)&&(e+=t);else{let t=-1;for(let i of n)(i=+r(i,++t,n))&&(e+=i)}return e}function V(n){var r=0,e=n.children,t=e&&e.length;if(!t)r=1;else for(;--t>=0;)r+=e[t].value;n.value=r}function X(){return this.eachAfter(V)}function Y(n,r){let e=-1;for(const t of this)n.call(r,t,++e,this);return this}function b(n,r){for(var e=this,t=[e],i,u,o=-1;e=t.pop();)if(n.call(r,e,++o,this),i=e.children)for(u=i.length-1;u>=0;--u)t.push(i[u]);return this}function B(n,r){for(var e=this,t=[e],i=[],u,o,f,s=-1;e=t.pop();)if(i.push(e),u=e.children)for(o=0,f=u.length;o<f;++o)t.push(u[o]);for(;e=i.pop();)n.call(r,e,++s,this);return this}function nn(n,r){let e=-1;for(const t of this)if(n.call(r,t,++e,this))return t}function en(n){return this.eachAfter(function(r){for(var e=+n(r.data)||0,t=r.children,i=t&&t.length;--i>=0;)e+=t[i].value;r.value=e})}function rn(n){return this.eachBefore(function(r){r.children&&r.children.sort(n)})}function tn(n){for(var r=this,e=un(r,n),t=[r];r!==e;)r=r.parent,t.push(r);for(var i=t.length;n!==e;)t.splice(i,0,n),n=n.parent;return t}function un(n,r){if(n===r)return n;var e=n.ancestors(),t=r.ancestors(),i=null;for(n=e.pop(),r=t.pop();n===r;)i=n,n=e.pop(),r=t.pop();return i}function on(){for(var n=this,r=[n];n=n.parent;)r.push(n);return r}function sn(){return Array.from(this)}function fn(){var n=[];return this.eachBefore(function(r){r.children||n.push(r)}),n}function an(){var n=this,r=[];return n.each(function(e){e!==n&&r.push({source:e.parent,target:e})}),r}function*hn(){var n=this,r,e=[n],t,i,u;do for(r=e.reverse(),e=[];n=r.pop();)if(yield n,t=n.children)for(i=0,u=t.length;i<u;++i)e.push(t[i]);while(e.length)}function O(n,r){n instanceof Map?(n=[void 0,n],r===void 0&&(r=dn)):r===void 0&&(r=ln);for(var e=new A(n),t,i=[e],u,o,f,s;t=i.pop();)if((o=r(t.data))&&(s=(o=Array.from(o)).length))for(t.children=o,f=s-1;f>=0;--f)i.push(u=o[f]=new A(o[f])),u.parent=t,u.depth=t.depth+1;return e.eachBefore(pn)}function cn(){return O(this).eachBefore(xn)}function ln(n){return n.children}function dn(n){return Array.isArray(n)?n[1]:null}function xn(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function pn(n){var r=0;do n.height=r;while((n=n.parent)&&n.height<++r)}function A(n){this.data=n,this.depth=this.height=0,this.parent=null}A.prototype=O.prototype={constructor:A,count:X,each:Y,eachAfter:B,eachBefore:b,find:nn,sum:en,sort:rn,path:tn,ancestors:on,descendants:sn,leaves:fn,links:an,copy:cn,[Symbol.iterator]:hn};function yn(n){return n==null?null:vn(n)}function vn(n){if(typeof n!="function")throw new Error;return n}function Z(){return 0}function gn(n){return function(){return n}}const mn=1664525,wn=1013904223,$=4294967296;function E(){let n=1;return()=>(n=(mn*n+wn)%$)/$}function _n(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function An(n,r){let e=n.length,t,i;for(;e;)i=r()*e--|0,t=n[e],n[e]=n[i],n[i]=t;return n}function jn(n){return P(n,E())}function P(n,r){for(var e=0,t=(n=An(Array.from(n),r)).length,i=[],u,o;e<t;)u=n[e],o&&Q(o,u)?++e:(o=kn(i=Mn(i,u)),e=0);return o}function Mn(n,r){var e,t;if(j(r,n))return[r];for(e=0;e<n.length;++e)if(w(r,n[e])&&j(d(n[e],r),n))return[n[e],r];for(e=0;e<n.length-1;++e)for(t=e+1;t<n.length;++t)if(w(d(n[e],n[t]),r)&&w(d(n[e],r),n[t])&&w(d(n[t],r),n[e])&&j(T(n[e],n[t],r),n))return[n[e],n[t],r];throw new Error}function w(n,r){var e=n.r-r.r,t=r.x-n.x,i=r.y-n.y;return e<0||e*e<t*t+i*i}function Q(n,r){var e=n.r-r.r+Math.max(n.r,r.r,1)*1e-9,t=r.x-n.x,i=r.y-n.y;return e>0&&e*e>t*t+i*i}function j(n,r){for(var e=0;e<r.length;++e)if(!Q(n,r[e]))return!1;return!0}function kn(n){switch(n.length){case 1:return qn(n[0]);case 2:return d(n[0],n[1]);case 3:return T(n[0],n[1],n[2])}}function qn(n){return{x:n.x,y:n.y,r:n.r}}function d(n,r){var e=n.x,t=n.y,i=n.r,u=r.x,o=r.y,f=r.r,s=u-e,a=o-t,h=f-i,c=Math.sqrt(s*s+a*a);return{x:(e+u+s/c*h)/2,y:(t+o+a/c*h)/2,r:(c+i+f)/2}}function T(n,r,e){var t=n.x,i=n.y,u=n.r,o=r.x,f=r.y,s=r.r,a=e.x,h=e.y,c=e.r,l=t-o,M=t-a,k=i-f,q=i-h,S=s-u,W=c-u,z=t*t+i*i-u*u,D=z-o*o-f*f+s*s,H=z-a*a-h*h+c*c,x=M*k-l*q,p=(k*H-q*D)/(x*2)-t,y=(q*S-k*W)/x,v=(M*D-l*H)/(x*2)-i,g=(l*W-M*S)/x,C=y*y+g*g-1,m=2*(u+p*y+v*g),L=p*p+v*v-u*u,N=-(Math.abs(C)>1e-6?(m+Math.sqrt(m*m-4*C*L))/(2*C):L/m);return{x:t+p+y*N,y:i+v+g*N,r:N}}function F(n,r,e){var t=n.x-r.x,i,u,o=n.y-r.y,f,s,a=t*t+o*o;a?(u=r.r+e.r,u*=u,s=n.r+e.r,s*=s,u>s?(i=(a+s-u)/(2*a),f=Math.sqrt(Math.max(0,s/a-i*i)),e.x=n.x-i*t-f*o,e.y=n.y-i*o+f*t):(i=(a+u-s)/(2*a),f=Math.sqrt(Math.max(0,u/a-i*i)),e.x=r.x+i*t-f*o,e.y=r.y+i*o+f*t)):(e.x=r.x+e.r,e.y=r.y)}function G(n,r){var e=n.r+r.r-1e-6,t=r.x-n.x,i=r.y-n.y;return e>0&&e*e>t*t+i*i}function I(n){var r=n._,e=n.next._,t=r.r+e.r,i=(r.x*e.r+e.x*r.r)/t,u=(r.y*e.r+e.y*r.r)/t;return i*i+u*u}function _(n){this._=n,this.next=null,this.previous=null}function U(n,r){if(!(u=(n=_n(n)).length))return 0;var e,t,i,u,o,f,s,a,h,c,l;if(e=n[0],e.x=0,e.y=0,!(u>1))return e.r;if(t=n[1],e.x=-t.r,t.x=e.r,t.y=0,!(u>2))return e.r+t.r;F(t,e,i=n[2]),e=new _(e),t=new _(t),i=new _(i),e.next=i.previous=t,t.next=e.previous=i,i.next=t.previous=e;n:for(s=3;s<u;++s){F(e._,t._,i=n[s]),i=new _(i),a=t.next,h=e.previous,c=t._.r,l=e._.r;do if(c<=l){if(G(a._,i._)){t=a,e.next=t,t.previous=e,--s;continue n}c+=a._.r,a=a.next}else{if(G(h._,i._)){e=h,e.next=t,t.previous=e,--s;continue n}l+=h._.r,h=h.previous}while(a!==h.next);for(i.previous=e,i.next=t,e.next=t.previous=t=i,o=I(e);(i=i.next)!==t;)(f=I(i))<o&&(e=i,o=f);t=e.next}for(e=[t._],i=t;(i=i.next)!==t;)e.push(i._);for(i=P(e,r),s=0;s<u;++s)e=n[s],e.x-=i.x,e.y-=i.y;return i.r}function Rn(n){return U(n,E()),n}function Cn(n){return Math.sqrt(n.value)}function En(){var n=null,r=1,e=1,t=Z;function i(u){const o=E();return u.x=r/2,u.y=e/2,n?u.eachBefore(J(n)).eachAfter(R(t,.5,o)).eachBefore(K(1)):u.eachBefore(J(Cn)).eachAfter(R(Z,1,o)).eachAfter(R(t,u.r/Math.min(r,e),o)).eachBefore(K(Math.min(r,e)/(2*u.r))),u}return i.radius=function(u){return arguments.length?(n=yn(u),i):n},i.size=function(u){return arguments.length?(r=+u[0],e=+u[1],i):[r,e]},i.padding=function(u){return arguments.length?(t=typeof u=="function"?u:gn(+u),i):t},i}function J(n){return function(r){r.children||(r.r=Math.max(0,+n(r)||0))}}function R(n,r,e){return function(t){if(i=t.children){var i,u,o=i.length,f=n(t)*r||0,s;if(f)for(u=0;u<o;++u)i[u].r+=f;if(s=U(i,e),f)for(u=0;u<o;++u)i[u].r-=f;t.r=s+f}}}function K(n){return function(r){var e=r.parent;r.r*=n,e&&(r.x=e.x+n*r.x,r.y=e.y+n*r.y)}}export{A as N,Z as a,gn as b,pn as c,Rn as d,jn as e,O as h,En as i,yn as o,vn as r,Nn as s};
